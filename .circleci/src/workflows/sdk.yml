when: << pipeline.parameters.run-sdk-workflow >>
jobs:
  - build-gcp-image:
      context: GCP

  - test:
      name: test-audius-libs
      context: GCP
      instance-name: circleci-test-audius-libs-$CIRCLE_BUILD_NUM
      service: audius-libs

  - test-audius-cmd:
      context: GCP
      instance-name: circleci-test-audius-cmd-$CIRCLE_BUILD_NUM

  - release-audius-sdk:
      sdk-release-commit: 7e1bb06c576e1675714696d9119c66fbf5bbe90c
      sdk-release-version: 2.0.3-beta.20
      context:
        - Audius Client
        - slack-secrets
