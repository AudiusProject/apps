services:
  core:
    container_name: core
    build:
      context: ${PROJECT_ROOT}
      dockerfile: ${PROJECT_ROOT}/cmd/audiusd/Dockerfile
      args:
        git_sha: '${GIT_COMMIT}'
    restart: unless-stopped
    environment:
      - NETWORK=dev
    profiles:
      - discovery
      - storage
    depends_on:
      db:
        condition: service_healthy
