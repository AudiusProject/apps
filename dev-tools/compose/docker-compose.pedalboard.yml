version: "3"

services:
  app-template:
    container_name: app-template
    build:
      context: ${PROJECT_ROOT}/discovery-provider/plugins/pedalboard
      dockerfile: ./docker/Dockerfile
      args:
        app_name: app-template
    restart: always
    profiles:
      - pedalboard

  trending-challenge-rewards:
    container_name: trending-challenge-rewards
    build:
      context: ${PROJECT_ROOT}/discovery-provider/plugins/pedalboard
      dockerfile: ./docker/Dockerfile
      args:
        app_name: trending-challenge-rewards
    restart: always

  relay:
    container_name: relay
    build:
      context: ${PROJECT_ROOT}/discovery-provider/plugins/pedalboard
      dockerfile: ./docker/Dockerfile
      args:
        app_name: relay
        git_sha: "${GIT_COMMIT}"
    restart: always
