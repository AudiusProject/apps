# Compose file to run the discovery flask server on its own
#
# The server is pointed at whatever database is set in .env
# and runs no workers, but does need redis and IPFS to be available
version: '3'
services:
  web-server:
    extends:
      file: docker-compose.common.yml
      service: discovery-provider
    ports:
      - '${audius_server_port}:${audius_server_port}'
    environment:
      - audius_db_run_migrations=false
      - audius_no_workers=true
      - WAIT_HOSTS=${COMPOSE_PROJECT_NAME}_redis-server_1:6379,${COMPOSE_PROJECT_NAME}-ipfs-node:5001
    depends_on:
      - redis-server

networks:
  audius_dev:
    external: true
